<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PR Analyzer (Standalone)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
    <!-- SheetJS for Excel Export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f9fafb; }
        .spinner { border: 4px solid #e5e7eb; border-top-color: #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        /* Custom Scrollbar for the table container */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <div class="spinner"></div>
            <p style="margin-top: 1rem; color: #6b7280;">Loading...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, Component, useMemo } = React;

        // --- Error Boundary ---
        class ErrorBoundary extends Component {
            constructor(props) { super(props); this.state = { hasError: false, error: null }; }
            static getDerivedStateFromError(error) { return { hasError: true, error }; }
            componentDidCatch(error, errorInfo) { console.error("Uncaught error:", error, errorInfo); }
            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen flex items-center justify-center bg-red-50 p-4">
                            <div className="bg-white p-6 rounded-lg shadow-lg max-w-lg w-full">
                                <h2 className="text-xl font-bold text-red-600 mb-4">Something went wrong</h2>
                                <pre className="bg-gray-100 p-3 rounded text-xs overflow-auto text-red-800">{this.state.error?.toString()}</pre>
                                <button onClick={() => window.location.reload()} className="mt-4 px-4 py-2 bg-red-600 text-white rounded">Reload Page</button>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        // --- Icons ---
        const Icons = {
            Sun: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>,
            Upload: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>,
            FileText: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/></svg>,
            PlayCircle: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>,
            Download: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
        };

        // --- Heatmap Color Logic ---
        // Low: #004C99 (Blue) -> High: #FF8C00 (Orange)
        const HEAT_COLORS = [
            { r: 0,   g: 76,  b: 153 }, // C0: #004C99 (Deep Blue - Low PR)
            { r: 102, g: 178, b: 255 }, // C1: #66B2FF (Light Blue)
            { r: 255, g: 224, b: 102 }, // C2: #FFE066 (Yellow)
            { r: 255, g: 140, b: 0   }  // C3: #FF8C00 (Deep Orange - High PR)
        ];

        const getHeatColor = (value, vMin, vMax) => {
            if (value === null || value === undefined) return '#f3f4f6'; // bg-gray-100
            
            // Clip vMin/vMax to reasonable PR ranges if not provided
            // Defaulting to 0-100 scale if min/max are same or invalid, but PR typically 60-90
            if (vMax === undefined) vMax = 90;
            if (vMin === undefined) vMin = 60;
            if (vMax <= vMin) { vMin = 0; vMax = 100; }

            // 1. Normalize
            let t = (value - vMin) / (vMax - vMin);
            t = Math.max(0, Math.min(1, t)); // Clip 0-1

            // 2. Interpolate
            let c0, c1, u;
            if (t < 0.33) {
                c0 = HEAT_COLORS[0]; c1 = HEAT_COLORS[1];
                u = t / 0.33;
            } else if (t < 0.66) {
                c0 = HEAT_COLORS[1]; c1 = HEAT_COLORS[2];
                u = (t - 0.33) / 0.33;
            } else {
                c0 = HEAT_COLORS[2]; c1 = HEAT_COLORS[3];
                u = (t - 0.66) / 0.34;
            }

            // 3. Lerp RGB
            const r = Math.round(c0.r * (1 - u) + c1.r * u);
            const g = Math.round(c0.g * (1 - u) + c1.g * u);
            const b = Math.round(c0.b * (1 - u) + c1.b * u);

            // 4. Hex
            const toHex = (x) => x.toString(16).padStart(2, "0");
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
        };

        // Helper to determine text color based on background luminance
        const getTextColor = (hexColor) => {
            if (!hexColor || hexColor === '#f3f4f6') return '#374151'; // Gray text for null
            const r = parseInt(hexColor.substr(1, 2), 16);
            const g = parseInt(hexColor.substr(3, 2), 16);
            const b = parseInt(hexColor.substr(5, 2), 16);
            const yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
            return (yiq >= 128) ? '#000000' : '#ffffff';
        };

        // --- Logic ---
        const processData = (rows, headers, meta) => {
            if (!rows || !headers) return null;

            // Regex for PCS columns
            const pcsRegex = /^(.+)_PCS/;
            const pcsColumns = headers.filter(h => pcsRegex.test(h));
            
            const dynamicPcsList = pcsColumns.map(col => {
                const match = col.match(pcsRegex);
                const id = match ? match[1] : col;
                return { id, ratedDcKw: 49.5 }; // Default rated DC
            });

            const plantDaily = [];
            let allPrValues = []; // To calculate min/max for heatmap
            
            rows.forEach(row => {
                if (!row.date) return;

                const pcsDetails = {}; // Store per-PCS PR for this day

                pcsColumns.forEach(col => { 
                    const val = parseFloat(row[col]);
                    
                    // Calculate individual PCS PR
                    const match = col.match(pcsRegex);
                    const id = match ? match[1] : col;
                    const irr = parseFloat(row.irradiation_kwhm2);
                    const ratedDc = 49.5; // Default
                    
                    let pr = null;
                    if (ratedDc > 0 && irr > 0 && !isNaN(val)) {
                        pr = (val / (irr * ratedDc)) * 100;
                        allPrValues.push(pr);
                    }
                    pcsDetails[id] = pr;
                });
                
                const irr = parseFloat(row.irradiation_kwhm2);

                plantDaily.push({
                    date: row.date,
                    irradiationKwhm2: isNaN(irr) ? 0 : irr,
                    pcsDetails: pcsDetails // Attach details
                });
            });

            // Calculate stats for Heatmap normalization
            // Filtering outliers: 5th and 95th percentile
            allPrValues.sort((a, b) => a - b);
            let vMin = 0, vMax = 100;
            if (allPrValues.length > 0) {
                const p5 = Math.floor(allPrValues.length * 0.05);
                const p95 = Math.floor(allPrValues.length * 0.95);
                vMin = allPrValues[p5];
                vMax = allPrValues[p95];
                // If range is too small, widen it slightly to avoid div by zero issues or flat colors
                if (vMax - vMin < 5) { vMin -= 2.5; vMax += 2.5; }
            }

            return {
                plantDaily,
                pcsList: dynamicPcsList.map(p => p.id), // Return list of IDs for headers
                stats: { vMin, vMax }
            };
        };

        const parseCsv = (file) => {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const buffer = e.target.result;
                    const dec = new TextDecoder("shift-jis");
                    const text = dec.decode(new Uint8Array(buffer));
                    
                    Papa.parse(text, {
                        header: true,
                        skipEmptyLines: true,
                        complete: (results) => {
                            const { data, meta } = results;
                            const headers = meta.fields || [];
                            if (!headers.includes('date')) return resolve({ success: false, error: 'Column "date" not found.' });
                            resolve({ success: true, data, headers });
                        },
                        error: (err) => resolve({ success: false, error: err.message })
                    });
                };
                reader.readAsArrayBuffer(file);
            });
        };


        // --- Components ---
        const Header = ({ onReset, hasData }) => (
            <header className="bg-white shadow-sm sticky top-0 z-50">
                <div className="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
                    <div className="flex items-center space-x-3">
                        <Icons.Sun className="text-amber-500" />
                        <span className="text-xl font-bold text-gray-900">PR Analyzer</span>
                    </div>
                    {hasData && <button onClick={onReset} className="text-sm font-medium text-blue-600 hover:text-blue-500">Upload New CSV</button>}
                </div>
            </header>
        );

        const TemplateGuide = ({ onDownload }) => (
            <div className="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <div className="p-8">
                    {/* Header */}
                    <div className="border-b pb-4 mb-6">
                        <h2 className="text-2xl font-bold text-gray-900">PR入力用 CSV テンプレート & 入力ガイド</h2>
                    </div>

                    {/* Description */}
                    <p className="text-gray-700 mb-6 leading-relaxed">
                        本アプリは、太陽光発電所の <strong>日次PR（Performance Ratio）</strong> を算出するために
                        所定フォーマットの CSV ファイルを入力として使用します。<br/>
                        下記テンプレートをダウンロードし、必要項目を入力してご利用ください。<br/>
                        カラム構造は <strong>厳密に固定</strong> されています。異なるヘッダ名やフォーマットを使用した場合、読み込みエラーとなります。
                    </p>

                    {/* Download Button */}
                    <div className="mb-10">
                        <button 
                            onClick={onDownload}
                            className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors shadow-md font-medium"
                        >
                            <Icons.Download width={18} height={18} />
                            CSVテンプレートをダウンロード
                        </button>
                    </div>

                    {/* Column Table */}
                    <h3 className="text-lg font-bold text-gray-900 mb-4">入力カラム一覧</h3>
                    <div className="overflow-x-auto mb-10 rounded-lg border border-gray-200">
                        <table className="table-auto w-full border-collapse text-sm text-left">
                            <thead className="bg-gray-100 text-gray-700">
                                <tr>
                                    <th className="border-b px-4 py-3 font-semibold">カラム名</th>
                                    <th className="border-b px-4 py-3 font-semibold">日本語</th>
                                    <th className="border-b px-4 py-3 font-semibold">単位</th>
                                    <th className="border-b px-4 py-3 font-semibold">PR計算への役割</th>
                                </tr>
                            </thead>
                            <tbody className="text-gray-600">
                                <tr className="bg-white border-b"><td className="px-4 py-2 font-mono text-xs">date</td><td className="px-4 py-2">日付</td><td className="px-4 py-2">―</td><td className="px-4 py-2">キー（日次レコード）</td></tr>
                                <tr className="bg-gray-50 border-b"><td className="px-4 py-2 font-mono text-xs font-bold text-blue-600">irradiation_kwhm2</td><td className="px-4 py-2 font-bold">積算日射量（kWh/m²）</td><td className="px-4 py-2">kWh/m²</td><td className="px-4 py-2 font-bold text-blue-600">PR分母（必須）</td></tr>
                                <tr className="bg-white border-b"><td className="px-4 py-2 font-mono text-xs font-bold text-blue-600">plant_pdc_kw</td><td className="px-4 py-2 font-bold">発電所DC定格容量</td><td className="px-4 py-2">kW</td><td className="px-4 py-2 font-bold text-blue-600">PR分母（必須）</td></tr>
                            </tbody>
                        </table>
                        <p className="p-3 text-xs text-gray-500 bg-gray-50 italic">※G列以降は <code>pcs_◯◯◯_kwh</code> の形式で PCS の日発電量を追加できます。</p>
                    </div>

                    {/* Rules Box */}
                    <h3 className="text-lg font-bold text-gray-900 mb-4">入力ルール（重要）</h3>
                    <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-10 text-sm text-gray-800 rounded-r-lg">
                        <ul className="space-y-2 list-disc list-inside">
                            <li><strong>ヘッダ名の変更は禁止：</strong> 例）<code>irradiation_kwhm2</code> を「日射量」に変更すると読み込み不可。</li>
                            <li><strong>plant_pdc_kw は1ファイル1値：</strong> 1行目の値が全期間に適用されます。</li>
                            <li><strong>PCS列の命名規則：</strong> <code>pcs_&lt;PCS-ID&gt;_kwh</code> を守ってください。（例：<code>pcs_1-7-1_kwh</code>）</li>
                            <li><strong>空欄の扱い：</strong> 発電量が空欄の場合、0kWhとして扱われます。</li>
                            <li><strong>irradiation_kwhm2 = 0 の日：</strong> PR計算不可のため、結果は「–」となります。</li>
                        </ul>
                    </div>

                    {/* Sample Code */}
                    <h3 className="text-lg font-bold text-gray-900 mb-4">サンプル CSV</h3>
                    <div className="relative group">
                        <pre className="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm font-mono leading-relaxed">
{`date,irradiation_kwhm2,plant_pdc_kw,pcs_1-7-1_kwh,pcs_1-7-2_kwh
2025-11-01,3.95,999,124.5,109.2
2025-11-02,3.10,999,93.1,90.3
2025-11-03,3.55,999,110.4,102.9`}
                        </pre>
                        <div className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity">
                            <span className="text-xs text-gray-400 px-2">Select & Copy</span>
                        </div>
                    </div>
                </div>
            </div>
        );

        const FileUploader = ({ onFileSelect, isLoading, error }) => (
            <div className="bg-white rounded-2xl shadow-xl border border-gray-100 text-center p-8">
                <div className="mx-auto h-16 w-16 bg-blue-50 rounded-full flex items-center justify-center mb-6">
                    {isLoading ? <div className="spinner text-blue-600"></div> : <Icons.Upload className="text-blue-600" style={{width:32, height:32}} />}
                </div>
                <h2 className="text-2xl font-bold text-gray-900 mb-3">{isLoading ? 'Processing...' : 'Upload Data'}</h2>
                {error && <div className="mb-6 p-4 bg-red-50 text-red-700 text-sm rounded-lg text-left">{error}</div>}
                <div className="space-y-4">
                    <label className="relative w-full flex items-center justify-center px-6 py-4 bg-blue-600 text-white rounded-xl cursor-pointer hover:bg-blue-700 shadow-lg transition-all">
                        <Icons.FileText className="mr-2" />
                        <span>Select CSV File</span>
                        <input type="file" accept=".csv" className="hidden" onChange={(e) => e.target.files[0] && onFileSelect(e.target.files[0])} disabled={isLoading} />
                    </label>
                </div>
                <p className="mt-4 text-xs text-gray-400">Supported: Shift-JIS / UTF-8 CSV</p>
            </div>
        );

        // --- Updated Daily Table ---
        const DailyTable = ({ data, pcsList, stats }) => {
            return (
                <div className="bg-white shadow border border-gray-200 sm:rounded-lg flex flex-col h-[calc(100vh-200px)]">
                    <div className="flex-1 overflow-auto">
                        <table className="min-w-full divide-y divide-gray-200 border-collapse">
                            <thead className="bg-gray-50 sticky top-0 z-10">
                                <tr>
                                    {/* Fixed Columns */}
                                    <th className="sticky left-0 z-20 bg-gray-50 px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-r shadow-sm min-w-[120px]">Date</th>
                                    <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b min-w-[100px] border-r-2 border-gray-300">Irrad (kWh/m²)</th>
                                    
                                    {/* Dynamic PCS Columns */}
                                    {pcsList.map(pcsId => (
                                        <th key={pcsId} className="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-b min-w-[90px] border-r border-gray-100">
                                            <div className="truncate w-20" title={pcsId}>{pcsId}</div>
                                        </th>
                                    ))}
                                </tr>
                            </thead>
                            <tbody className="bg-white divide-y divide-gray-200">
                                {data.map((row, i) => (
                                    <tr key={i} className="hover:bg-gray-50">
                                        {/* Fixed Data */}
                                        <td className="sticky left-0 z-10 bg-white px-4 py-3 text-sm font-medium text-gray-900 whitespace-nowrap border-r shadow-sm">{row.date}</td>
                                        <td className="px-4 py-3 text-sm text-gray-500 whitespace-nowrap border-r-2 border-gray-300">{row.irradiationKwhm2?.toFixed(2)}</td>
                                        
                                        {/* Dynamic PCS Data with Heatmap */}
                                        {pcsList.map(pcsId => {
                                            const pr = row.pcsDetails && row.pcsDetails[pcsId];
                                            const bgColor = getHeatColor(pr, stats.vMin, stats.vMax);
                                            const textColor = getTextColor(bgColor);
                                            
                                            return (
                                                <td key={pcsId} className="px-2 py-3 text-sm text-center whitespace-nowrap border-r border-gray-100" style={{backgroundColor: pr ? bgColor : 'transparent'}}>
                                                     <span 
                                                        className="px-1.5 py-0.5 rounded text-xs font-medium"
                                                        style={{ color: pr ? textColor : '#9ca3af' }}
                                                     >
                                                        {pr ? pr.toFixed(1) + '%' : '-'}
                                                    </span>
                                                </td>
                                            );
                                        })}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [status, setStatus] = useState('idle');
            const [data, setData] = useState(null);
            const [error, setError] = useState(null);

            const handleProcess = async (loader) => {
                setStatus('loading');
                setError(null);
                try {
                    const result = await loader();
                    if(!result.success) throw new Error(result.error);
                    const pData = processData(result.data || result.rows, result.headers, {});
                    if(!pData) throw new Error("Failed to process data");
                    setData(pData);
                    setStatus('loaded');
                } catch(e) {
                    console.error(e);
                    setError(e.message);
                    setStatus('error');
                }
            };

            const exportToExcel = () => {
                if (!data) return;

                // 1. Construct Header
                const headers = ['Date', 'Irradiation (kWh/m²)', ...data.pcsList];

                // 2. Construct Rows (Values Only - Standard SheetJS doesn't support cell styles in free version easily)
                const rows = data.plantDaily.map(row => {
                    const pcsValues = data.pcsList.map(id => {
                        const val = row.pcsDetails && row.pcsDetails[id];
                        return val !== null && val !== undefined ? val : ''; 
                    });
                    return [row.date, row.irradiationKwhm2, ...pcsValues];
                });

                // 3. Create Workbook
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet([headers, ...rows]);
                
                // Append sheet
                XLSX.utils.book_append_sheet(wb, ws, "PR Analysis");

                // 4. Download
                const fileName = `PR_Analysis_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, fileName);
            };

            // --- Template Download Function ---
            const downloadTemplate = () => {
                const csvContent = "date,irradiation_kwhm2,plant_pdc_kw,pcs_1-1-1_kwh,pcs_1-1-2_kwh\n";
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement("a");
                link.setAttribute("href", url);
                link.setAttribute("download", "input_template.csv");
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            return (
                <div className="min-h-screen bg-gray-50 pb-10">
                    <Header hasData={status === 'loaded'} onReset={() => setStatus('idle')} />
                    <main className="max-w-[95%] mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {status === 'error' && <div className="mb-6 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg">Error: {error}<button onClick={() => setStatus('idle')} className="ml-4 underline">Try Again</button></div>}
                        
                        {status !== 'loaded' && (
                            <div className="max-w-4xl mx-auto space-y-12">
                                {/* 1. File Uploader Section */}
                                <FileUploader isLoading={status === 'loading'} error={null}
                                    onFileSelect={(f) => handleProcess(() => parseCsv(f))}
                                />

                                {/* 2. Template & Guide Section */}
                                <TemplateGuide onDownload={downloadTemplate} />
                            </div>
                        )}

                        {status === 'loaded' && data && (
                            <div className="animate-fade-in">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-xl font-bold text-gray-900">PCS Performance Overview</h2>
                                    <div className="flex items-center space-x-4">
                                        <div className="text-sm text-gray-500">
                                            Showing {data.pcsList.length} PCS units
                                        </div>
                                        <div className="flex items-center space-x-1 text-xs text-gray-500 border-l pl-4">
                                            <span className="w-3 h-3 rounded-sm" style={{backgroundColor:'#004C99'}}></span><span>Low</span>
                                            <span className="w-3 h-3 rounded-sm ml-1" style={{backgroundColor:'#FFE066'}}></span><span>Avg</span>
                                            <span className="w-3 h-3 rounded-sm ml-1" style={{backgroundColor:'#FF8C00'}}></span><span>High</span>
                                        </div>
                                        <button 
                                            onClick={exportToExcel}
                                            className="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors"
                                        >
                                            <Icons.Download className="mr-2 h-4 w-4" />
                                            Export Excel
                                        </button>
                                    </div>
                                </div>
                                <DailyTable data={data.plantDaily} pcsList={data.pcsList} stats={data.stats} />
                            </div>
                        )}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ErrorBoundary><App /></ErrorBoundary>);
    </script>
</body>
</html>
